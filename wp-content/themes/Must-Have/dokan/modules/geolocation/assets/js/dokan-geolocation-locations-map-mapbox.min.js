!function(e){var o={};function t(a){if(o[a])return o[a].exports;var n=o[a]={i:a,l:!1,exports:{}};return e[a].call(n.exports,n,n.exports,t),n.l=!0,n.exports}t.m=e,t.c=o,t.d=function(e,o,a){t.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:a})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,o){if(1&o&&(e=t(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var n in e)t.d(a,n,function(o){return e[o]}.bind(null,n));return a},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},t.p="",t(t.s=57)}({57:function(e,o){var t;t=jQuery,DokanGeo.LocationsMaps={map:null,mapboxId:"dokan-geolocation-locations-map",items:[],data:{type:"FeatureCollection",features:[]},marker:{image:null,clusterer:null},init:function(){var e=this,o={longitude:0,latitude:0};mapboxgl.accessToken=DokanGeo.mapbox_access_token,e.map=new mapboxgl.Map({container:e.mapboxId,style:"mapbox://styles/mapbox/streets-v10",center:[DokanGeo.default_geolocation.longitude,DokanGeo.default_geolocation.latitude],zoom:DokanGeo.map_zoom}),e.map.addControl(new mapboxgl.NavigationControl),e.items=t('[name="dokan_geolocation[]"]'),e.items.each((function(a){t(this).val();var n=t(this).data("latitude"),r=t(this).data("longitude"),i={type:"Feature",properties:{id:"dokan-geolocation-item-"+a,info:t(this).data("info")},geometry:{type:"Point",coordinates:[r,n,0]}};e.data.features.push(i),o.longitude+=r,o.latitude+=n})),o.longitude&&o.latitude&&e.map.setCenter([o.longitude/e.items.length,o.latitude/e.items.length]),e.map.on("load",(function(){e.loadImages("image",DokanGeo.marker.image),e.loadImages("clusterer",DokanGeo.marker.clusterer)}))},loadImages:function(e,o){var t=this;t.map.loadImage(o,(function(o,a){o||(t.marker[e]=a,t.map.addImage("dokan-marker-"+e,a),t.addMapLayers())}))},addMapLayers:function(){var e=this;e.marker.image&&e.marker.clusterer&&(e.map.addSource("dokan_geolocation_map_main_data",{type:"geojson",data:e.data,cluster:!0,clusterMaxZoom:14,clusterRadius:50}),e.map.addLayer({id:"clusters",type:"symbol",source:"dokan_geolocation_map_main_data",filter:["has","point_count"],layout:{"icon-image":"dokan-marker-clusterer","icon-allow-overlap":!0,"text-allow-overlap":!0}}),e.map.addLayer({id:"cluster-count",type:"symbol",source:"dokan_geolocation_map_main_data",filter:["has","point_count"],layout:{"text-field":"{point_count_abbreviated}","text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12},paint:{"text-color":"rgb(253, 218, 206)"}}),e.map.addLayer({id:"unclustered-point",type:"symbol",source:"dokan_geolocation_map_main_data",filter:["!",["has","point_count"]],layout:{"icon-image":"dokan-marker-image","icon-allow-overlap":!0,"text-allow-overlap":!0}}),e.map.on("click","clusters",(function(o){var a=e.map.queryRenderedFeatures(o.point,{layers:["clusters"]})[0].properties.cluster_id;e.map.getSource("dokan_geolocation_map_main_data").getClusterLeaves(a,255,0,(function(o,n){if(e.map.getZoom()>9&&n.length>1){var r='<div class="white-popup dokan-geo-map-info-windows-in-popup">',i=0;for(i=0;i<n.length;i++)r+=e.getInfoWindowContent(n[i].properties.info);r+="</div>",t.magnificPopup.open({items:{type:"inline",src:r}})}else e.map.getSource("dokan_geolocation_map_main_data").getClusterExpansionZoom(a,(function(o,t){o||e.map.easeTo({center:n[0].geometry.coordinates,zoom:t})}))}))})),e.map.on("mouseenter","clusters",(function(){e.map.getCanvas().style.cursor="pointer"})),e.map.on("mouseleave","clusters",(function(){e.map.getCanvas().style.cursor=""})),e.map.on("click","unclustered-point",(function(o){var t=e.map.queryRenderedFeatures(o.point,{layers:["unclustered-point"]})[0].properties.info;t&&(e.map.easeTo({center:o.lngLat}),new mapboxgl.Popup({closeOnClick:!0}).setLngLat(o.lngLat).setHTML(e.getInfoWindowContent(t)).setMaxWidth("654px").addTo(e.map))})))},getInfoWindowContent:function(e){"string"==typeof e&&(e=JSON.parse(e));var o,t=DokanGeo.info_window_template;for(o in e)t=t.replace("{"+o+"}",e[o]);return t}},t("#dokan-geolocation-locations-map").length&&DokanGeo.mapbox_access_token&&DokanGeo.LocationsMaps.init()}});